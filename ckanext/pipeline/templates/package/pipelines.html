{% extends 'package/edit_base.html' %}

{% block subtitle %}{{ _('Pipelines') }} - {{ h.dataset_display_name(pkg) }}{% endblock %}

{% set controller = 'ckanext.controllers.pipeline:ICController' %}

{% block page_primary_action %}
  {% link_for _('Assign pipeline'), controller=controller, action='assign_pipeline', id=c.pkg_dict.name, class_='btn', icon='plus' %}
{% endblock %}

{% block primary_content_inner %}
	{% set pipelines = h.get_dataset_pipelines(c.pkg_dict['id']) %}
	{% if pipelines|length > 0 %}
		<ul class="dataset-list unstyled">
		  {% for pipe in pipelines %}
		  <li class="dataset-item">
		  	<div class="dataset-content">
		  	  <h3 class="dataset-heading">
                {{ _(pipe['name']) }}  {% link_for _(''), controller=controller, action='remove_pipe', package_id=c.pkg_dict.id, pipeline_id=pipe['id'], class_='btn', icon='minus' %}
		      </h3>
		      <div>{{ _(pipe['description']) }}</div>
		  	</div>
		  </li>
		  {% endfor %}
		</ul>
	{% else %}
		<p>No pipelines assigned.</p>
	{% endif %}
{% endblock %}
